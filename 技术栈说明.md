# 技术说明文档

本文从工程实现角度说明项目的技术栈与关键实现方式，方便后续接手与扩展。

## 1. 运行环境与构建

- 运行时：Node.js（本项目基于 Vite 构建）
  - 功能：提供本地开发与构建所需的运行环境与包管理基础
- 构建工具：Vite 6
  - 功能：提供开发服务器、热更新与生产构建产物输出
- 语言：TypeScript 5
  - 功能：为组件、状态与接口提供类型约束，降低联调出错率
- 模块规范：ESM（`package.json` 中 `type: "module"`）
  - 功能：统一模块加载方式，方便与 Vite/现代工具链协作

说明：开发时通过 `vite` 提供 dev server，生产构建通过 `vite build` 输出静态资源。

## 2. 前端框架与渲染

- React 19 + ReactDOM 19
  - 功能：提供组件化 UI 与状态管理基础
- 入口：`index.tsx` 挂载根组件 `App`
  - 功能：初始化渲染树并承载全局布局与路由入口（当前无路由）

说明：采用函数式组件与 Hooks（`useState`/`useEffect`/`useCallback`）组织状态与交互逻辑。

## 3. UI 与样式方案

- Tailwind CSS（通过 CDN 注入，配置在 `index.html`）
  - 功能：快速搭建界面样式与布局，减少手写 CSS
- 自定义主题色与阴影：`tailwind.config` 在运行时注入
  - 功能：统一主题色与阴影规范，保证视觉一致性
- 额外样式：`index.html` 内联样式用于 Range 输入控件与动画
  - 功能：补足原生控件样式与简单动效

说明：目前未使用本地 CSS 预处理或 CSS Modules，主要依赖 Tailwind 原子类。

## 4. 组件与可视化

- 组件拆分：`components/MetricCard.tsx`、`components/RadialControl.tsx`
  - 功能：复用核心 UI 单元（指标卡片、旋钮控制）
- 图表库：Recharts（湿度趋势折线图）
  - 功能：渲染趋势折线图，展示历史变化
- 图标库：Lucide React（界面图标）
  - 功能：提供统一风格的功能图标

说明：图表当前使用本地 mock 数据 `MOCK_HISTORY`，用于占位展示趋势。

## 5. 数据与业务层

- 领域类型：`types.ts` 定义基础数据结构（`SoilMetrics`、`RobotState` 等）
  - 功能：统一数据形态，保证组件与服务层的接口一致
- 设备接口层：`services/robotApi.ts`
  - 功能：封装设备控制与传感数据读取的调用入口
  - 当前为 mock 实现：包含延迟模拟与随机传感器数据
  - 未来对接真实后端时，可在该文件内替换实现

## 6. 分析服务接入

- SDK：`@google/genai`
  - 功能：调用外部分析服务并返回建议文本
- 适配层：`services/geminiService.ts`
  - 功能：统一封装分析请求，供界面调用

说明：该模块封装为“外部分析服务”适配层，后续可替换为自建服务。

## 7. 配置与环境变量

- 本地配置：`.env.local`
  - 功能：保存本地密钥与运行参数（不进仓库）
- 读取方式：`vite.config.ts` 中通过 `loadEnv` 注入到 `process.env`
  - 功能：在构建阶段把环境变量注入前端代码
- 使用点：分析服务调用（`services/geminiService.ts`）
  - 功能：为分析服务提供访问凭据

注意：未配置 Key 时会返回提示文案，不影响界面运行。

## 8. 目录结构（核心部分）

```
components/          # 复用 UI 组件
services/            # API 与外部服务封装
App.tsx              # 主要界面与交互逻辑
index.tsx            # 应用入口
types.ts             # 类型定义
vite.config.ts       # Vite 配置
```

## 9. 当前实现边界

- 仅覆盖前端交互与流程验证
- 设备控制与传感数据为 mock
- 图表与部分展示数据为占位

如果需要接入真实设备/后端，建议从 `services/robotApi.ts` 与分析服务模块开始替换。
